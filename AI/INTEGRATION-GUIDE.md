# 真实数据集成指南

## 🎯 目标
将真实的温湿度传感器数据集成到您现有的主界面天气板块中。

## ✅ 已完成的修改

我已经修改了您现有的 `js/weather-service.js` 文件，现在它会：

1. **连接真实API** - 调用Node.js代理服务器获取真实传感器数据
2. **显示真实数据** - 温度和湿度显示2位小数的真实数值
3. **数据来源标识** - 显示"(真实数据)"标识
4. **自动更新** - 每30秒自动获取最新数据
5. **错误处理** - 代理服务器未运行时显示提示信息

## 🚀 使用步骤

### 1. 启动Node.js代理服务器
```bash
# 方法1：使用批处理文件
双击运行 start-node-server.bat

# 方法2：手动启动
node proxy-server.js
```

### 2. 访问您的主界面
```
http://localhost:8080/index.html
```

### 3. 查看天气板块
现在天气板块会显示：
- **真实温度**：如 24.56°C (2位小数)
- **真实湿度**：如 67.82% (2位小数)
- **数据来源**：🌡️ 农场监测点 (真实数据)
- **更新时间**：显示最后更新时间

## 📊 数据对比

### 修改前（模拟数据）
- 温度：22°C
- 湿度：65%
- 位置：📍 某市
- 数据：固定不变

### 修改后（真实数据）
- 温度：24.56°C
- 湿度：67.82%
- 位置：🌡️ 农场监测点 (真实数据)
- 数据：每30秒更新，来自真实传感器

## 🔧 技术细节

### 修改的文件
- `js/weather-service.js` - 主要修改文件

### 新增功能
1. `fetchRealWeatherData()` - 获取真实传感器数据
2. `convertSensorDataToWeatherFormat()` - 数据格式转换
3. `showProxyServerNotice()` - 代理服务器提示
4. `addTimestampDisplay()` - 时间戳显示

### API调用
```javascript
// 调用地址
http://localhost:3000/api/weather

// 返回数据格式
{
    "temperature": 24.56,
    "humidity": 67.82,
    "timestamp": "2025/8/27 10:30:15",
    "success": true
}
```

## 🎨 UI变化

### 天气主卡片
- 温度显示更精确（2位小数）
- 位置显示为"农场监测点 (真实数据)"
- 根据真实温度自动调整天气状况图标

### 环境数据卡片
- 湿度显示真实传感器数值（2位小数）
- 体感温度根据真实数据计算
- 添加数据更新时间显示

### 农事建议
- 根据真实温湿度数据生成建议
- 更准确的耕种适宜性判断

## ⚠️ 注意事项

1. **代理服务器必须运行** - 否则会显示提示信息
2. **端口冲突** - 确保3000端口未被占用
3. **网络连接** - 需要能访问云平台API
4. **数据更新** - 每30秒自动更新一次

## 🔍 故障排除

### 问题1：显示"需要启动代理服务器"
**解决**：运行 `node proxy-server.js`

### 问题2：数据不更新
**解决**：检查代理服务器控制台是否有错误信息

### 问题3：显示"--"
**解决**：检查云平台API连接和账号密码

## 🎉 成功标志

当一切正常时，您的主界面天气板块会显示：
- ✅ 真实的温度数值（如：24.56°C）
- ✅ 真实的湿度数值（如：67.82%）
- ✅ "(真实数据)"标识
- ✅ 自动更新的时间戳
- ✅ 每30秒数据刷新

现在您的系统已经成功集成了真实的传感器数据！